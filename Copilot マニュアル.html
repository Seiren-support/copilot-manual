<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>⚡️ インタラクティブ Copilot実践マニュアル</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
    
    <style>
        /* ============================================== */
        /* === Tailwind CSS相当の定義 === */
        /* ============================================== */
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        @keyframes ping {
            75%, 100% {
                transform: scale(2);
                opacity: 0;
            }
        }
        
        @keyframes pulse {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: .5;
            }
        }
        
        @keyframes bounce {
            0%, 100% {
                transform: translateY(-25%);
                animation-timing-function: cubic-bezier(0.8,0,1,1);
            }
            50% {
                transform: none;
                animation-timing-function: cubic-bezier(0,0,0.2,1);
            }
        }
        
        *, ::before, ::after {
            box-sizing: border-box;
            border-width: 0;
            border-style: solid;
            border-color: #e5e7eb;
        }
        
        ::before, ::after {
            --tw-content: '';
        }
        
        html {
            line-height: 1.5;
            -webkit-text-size-adjust: 100%;
            font-family: ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
        }
        
        body {
            margin: 0;
            line-height: inherit;
            /* antialiased */
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            font-family: 'Noto Sans JP', sans-serif;
            background-color: #F8F5F2; /* bg-gray-50 相当の色 */
            color: #4A4A4A;
        }

        /* content-container: 中央寄せを保証するカスタムコンテナ（以前のコードから流用） */
        .content-container {
            width: 100%;
            max-width: 1280px;
            margin-left: auto;
            margin-right: auto;
            padding-left: 1rem;
            padding-right: 1rem;
        }
        @media (min-width: 640px) { /* sm: */
            .content-container {
                padding-left: 1.5rem;
                padding-right: 1.5rem;
            }
        }
        @media (min-width: 1024px) { /* lg: */
            .content-container {
                padding-left: 2rem;
                padding-right: 2rem;
            }
        }
        
        /* Tailwindクラスの直接定義 */
        
        /* Header */
        .shadow-sm { box-shadow: 0 1px 1px rgba(0,0,0,0.05); }
        .sticky { position: sticky; }
        .top-0 { top: 0; }
        .z-40 { z-index: 40; }
        .bg-white { background-color: #fff; }
        .text-2xl { font-size: 1.5rem; line-height: 2rem; }
        .text-sm { font-size: 0.875rem; line-height: 1.25rem; }
        .font-bold { font-weight: 700; }
        .text-\[\#5F9EA0\] { color: #5F9EA0; }
        .py-4 { padding-top: 1rem; padding-bottom: 1rem; }
        .flex { display: flex; }
        .justify-between { justify-content: space-between; }
        .items-center { align-items: center; }

        /* Main/Sections */
        .py-12 { padding-top: 3rem; padding-bottom: 3rem; }
        .mb-16 { margin-bottom: 4rem; }
        .mb-4 { margin-bottom: 1rem; }
        .mb-6 { margin-bottom: 1.5rem; }
        .mb-8 { margin-bottom: 2rem; }
        .text-center { text-align: center; }
        .text-4xl { font-size: 2.25rem; line-height: 2.5rem; }
        .text-lg { font-size: 1.125rem; line-height: 1.75rem; }
        .text-gray-600 { color: #4b5563; }
        .max-w-3xl { max-width: 48rem; }
        .mx-auto { margin-left: auto; margin-right: auto; }
        
        /* Quickstart Grid (カード) */
        .grid { display: grid; }
        .gap-8 { gap: 2rem; }
        .md\:grid-cols-3 { grid-template-columns: repeat(3, minmax(0, 1fr)); }
        @media (max-width: 767px) {
            .md\:grid-cols-3 { grid-template-columns: repeat(1, minmax(0, 1fr)); }
        }
        .p-6 { padding: 1.5rem; }
        .rounded-lg { border-radius: 0.5rem; }
        .shadow-lg { box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); }
        .shadow-xl { box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.05); } /* 追加 */
        .text-xl { font-size: 1.25rem; line-height: 1.75rem; }
        .mb-2 { margin-bottom: 0.5rem; }
        .transition-all { transition-property: all; transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1); transition-duration: 300ms; } /* 追加 */
        
        /* Quickstart Card Hover */
        .quickstart-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
            background-color: #f9fafb; /* bg-gray-50 相当 */
        }

        /* Explorer Filters & Grid */
        .flex-wrap { flex-wrap: wrap; }
        .gap-2 { gap: 0.5rem; }
        .rounded-full { border-radius: 9999px; }
        .bg-gray-200 { background-color: #e5e7eb; }
        .hover\:bg-gray-300:hover { background-color: #d1d5db; }
        .px-4 { padding-left: 1rem; padding-right: 1rem; }
        .py-2 { padding-top: 0.5rem; padding-bottom: 0.5rem; }
        
        /* 検索バーのスタイル */
        .input-text {
            width: 100%;
            padding: 0.75rem 1rem;
            border-radius: 0.375rem; /* rounded-md */
            border: 1px solid #d1d5db; /* border-gray-300 */
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            outline: none;
            transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
        }
        .input-text:focus {
            border-color: #5F9EA0;
            box-shadow: 0 0 0 3px rgba(95, 158, 160, 0.5);
        }


        .md\:grid-cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); }
        .lg\:grid-cols-3 { grid-template-columns: repeat(3, minmax(0, 1fr)); }
        @media (min-width: 768px) {
            .md\:grid-cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); }
        }
        @media (min-width: 1024px) {
            .lg\:grid-cols-3 { grid-template-columns: repeat(3, minmax(0, 1fr)); }
        }

        /* Use Case Card */
        .cursor-pointer { cursor: pointer; }
        .text-xs { font-size: 0.75rem; line-height: 1rem; }
        .font-semibold { font-weight: 600; }
        .mr-2 { margin-right: 0.5rem; }
        .px-2\.5 { padding-left: 0.625rem; padding-right: 0.625rem; }
        .py-0\.5 { padding-top: 0.125rem; padding-bottom: 0.125rem; }
        .bg-\[\#E0F2F1\] { background-color: #E0F2F1; }
        .text-\[\#00796B\] { color: #00796B; }
        .use-case-card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .use-case-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }
        /* カード非表示用 */
        .hidden-card {
            display: none;
        }

        /* Best Practices */
        .border-l-4 { border-left-width: 4px; }
        .border-green-500 { border-color: #10b981; }
        .bg-green-50 { background-color: #ecfdf5; }
        .border-red-500 { border-color: #ef4444; }
        .bg-red-50 { background-color: #fef2f2; }
        .list-disc { list-style-type: disc; }
        .list-inside { list-style-position: inside; }
        .space-y-1 > :not([hidden]) ~ :not([hidden]) { --tw-space-y-reverse: 0; margin-top: calc(0.25rem * calc(1 - var(--tw-space-y-reverse))); margin-bottom: calc(0.25rem * var(--tw-space-y-reverse)); }
        .gap-4 { gap: 1rem; }
        
        /* FAQ */
        .max-w-3xl { max-width: 48rem; }
        .space-y-4 > :not([hidden]) ~ :not([hidden]) { --tw-space-y-reverse: 0; margin-top: calc(1rem * calc(1 - var(--tw-space-y-reverse))); margin-bottom: calc(1rem * var(--tw-space-y-reverse)); }
        .w-full { width: 100%; }
        .text-left { text-align: left; }
        .transition-transform { transition-property: transform; transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1); transition-duration: 300ms; }
        .duration-300 { transition-duration: 300ms; }
        .rotate-45 { transform: rotate(45deg); }
        
        /* Footer */
        .mt-16 { margin-top: 4rem; }
        .border-t { border-top-width: 1px; }
        .text-gray-500 { color: #6b7280; }
        .mt-2 { margin-top: 0.5rem; }
        .hover\:underline:hover { text-decoration-line: underline; }

        /* ============================================== */
        /* === モーダル（動作安定化のためのカスタムCSS） === */
        /* ============================================== */
        .modal {
            position: fixed;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
            background-color: rgba(0, 0, 0, 0.6);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 50;
            padding: 1rem;
            /* 表示/非表示のトランジション */
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }
        
        /* JSで追加/削除する表示状態のクラス */
        .modal.is-visible {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background-color: #fff;
            border-radius: 0.5rem;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            width: 100%;
            max-width: 42rem;
            max-height: 90vh;
            overflow-y: auto;
            padding: 2rem;
            /* サイズ変化のトランジション */
            transform: scale(0.95); /* 初期状態をわずかに縮小 */
            transition: transform 0.3s ease;
        }

        /* JSで追加/削除するモーダル出現時のスケール変化クラス */
        .modal.is-visible .modal-content {
            transform: scale(1);
        }
        
        /* その他のModal関連クラス */
        .space-y-6 > :not([hidden]) ~ :not([hidden]) { --tw-space-y-reverse: 0; margin-top: calc(1.5rem * calc(1 - var(--tw-space-y-reverse))); margin-bottom: calc(1.5rem * var(--tw-space-y-reverse)); }
        .border-b-2 { border-bottom-width: 2px; }
        .pb-1 { padding-bottom: 0.25rem; }
        .bg-gray-100 { background-color: #f3f4f6; }
        .whitespace-pre-wrap { white-space: pre-wrap; }
        .relative { position: relative; }
        .absolute { position: absolute; }
        .top-2 { top: 0.5rem; }
        .right-2 { right: 0.5rem; }
        .text-white { color: #fff; }
        .hover\:bg-\[\#4d8c8e\]:hover { background-color: #4d8c8e; }
        
        /* Custom styles (その他) */
        .filter-btn.active {
            background-color: #5F9EA0;
            color: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .filter-btn {
            transition: all 0.3s ease;
        }
        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-out;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }
        
        /* RAPフレームワークのためのスタイル */
        .rap-item {
            display: flex;
            align-items: flex-start;
            gap: 1rem;
            padding: 1rem;
            background-color: #ffffff;
            border-radius: 0.5rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }
        .rap-icon {
            font-size: 2.5rem;
            color: #5F9EA0;
            flex-shrink: 0;
            line-height: 1;
        }
        .rap-text h4 {
            font-size: 1.125rem;
            font-weight: 700;
            margin-bottom: 0.25rem;
        }
        .rap-text p {
            color: #4b5563;
        }
    </style>
</head>
<body class="antialiased">

    <header class="bg-white shadow-sm sticky top-0 z-40">
        <div class="content-container py-4 flex justify-between items-center">
            <h1 class="text-2xl font-bold text-[#5F9EA0]">⚡️ Copilot実践マニュアル (強化版)</h1>
            <div class="text-sm">
                <span>最終更新:</span>
                <span id="last-updated">2025/11/18</span>
            </div>
        </div>
    </header>

    <main class="content-container py-12">
        
        <section id="hero" class="text-center mb-16">
            <h2 class="text-4xl font-bold mb-4">あなたのAIアシスタントを、最大限に活用しよう。</h2>
            <p class="text-lg text-gray-600 max-w-3xl mx-auto">このマニュアルは、Copilotの能力を引き出すための**「実践的な遊び場」**です。知りたいことから、できることを探してみましょう。</p>
        </section>

        <section id="quickstart" class="mb-16">
            <h3 class="text-2xl font-bold mb-6 text-center">まずはここから：Copilotの４つの基本能力</h3>
            <div class="grid md:grid-cols-3 gap-8">
                <div class="quickstart-card bg-white p-6 rounded-lg shadow-lg text-center transition-all">
                    <div class="text-4xl mb-4">📝</div>
                    <h4 class="text-xl font-bold mb-2">要約する (Summarize)</h4>
                    <p class="text-gray-600">長いメール、会議、ドキュメントの内容を瞬時に把握。重要なポイントだけを抜き出します。</p>
                </div>
                <div class="quickstart-card bg-white p-6 rounded-lg shadow-lg text-center transition-all">
                    <div class="text-4xl mb-4">✨</div>
                    <h4 class="text-xl font-bold mb-2">作成する (Create)</h4>
                    <p class="text-gray-600">アイデアを伝えるだけで、メールの文章、プレゼンテーション、企画書などをゼロから生成します。</p>
                </div>
                <div class="quickstart-card bg-white p-6 rounded-lg shadow-lg text-center transition-all">
                    <div class="text-4xl mb-4">🔗</div>
                    <h4 class="text-xl font-bold mb-2">連携・検索 (Connect)</h4>
                    <p class="text-gray-600">組織内のファイル、メール、チャットを横断的に検索し、個人化された回答を引き出します。</p>
                </div>
            </div>
        </section>
        
        <section id="explorer" class="mb-16">
            <h3 class="text-2xl font-bold mb-2 text-center">ユースケース・エクスプローラー</h3>
            <p class="text-center text-gray-600 mb-8">「何ができるか」を目的から探せます。アプリとタスクで絞り込んで、あなたの仕事に役立つ使い方を見つけましょう。</p>

            <div class="bg-white p-6 rounded-lg shadow-lg mb-8">
                <div class="mb-6">
                    <h4 class="font-bold mb-2">キーワードで検索:</h4>
                    <input type="text" id="search-input" class="input-text" placeholder="例: 会議、メール、売上分析、コード など">
                </div>
                <div class="mb-4">
                    <h4 class="font-bold mb-2">アプリで絞り込む (複数選択可):</h4>
                    <div id="app-filters" class="flex flex-wrap gap-2">
                        <button class="filter-btn active px-4 py-2 text-sm rounded-full bg-gray-200 hover:bg-gray-300" data-filter="all">すべて</button>
                        <button class="filter-btn px-4 py-2 text-sm rounded-full bg-gray-200 hover:bg-gray-300" data-filter="Teams">Teams</button>
                        <button class="filter-btn px-4 py-2 text-sm rounded-full bg-gray-200 hover:bg-gray-300" data-filter="Outlook">Outlook</button>
                        <button class="filter-btn px-4 py-2 text-sm rounded-full bg-gray-200 hover:bg-gray-300" data-filter="PowerPoint">PowerPoint</button>
                        <button class="filter-btn px-4 py-2 text-sm rounded-full bg-gray-200 hover:bg-gray-300" data-filter="Word">Word</button>
                        <button class="filter-btn px-4 py-2 text-sm rounded-full bg-gray-200 hover:bg-gray-300" data-filter="Excel">Excel</button>
                        <button class="filter-btn px-4 py-2 text-sm rounded-full bg-gray-200 hover:bg-gray-300" data-filter="Graph">組織全体</button>
                    </div>
                </div>
                <div>
                    <h4 class="font-bold mb-2">タスクで絞り込む (複数選択可):</h4>
                    <div id="task-filters" class="flex flex-wrap gap-2">
                        <button class="filter-btn active px-4 py-2 text-sm rounded-full bg-gray-200 hover:bg-gray-300" data-filter="all">すべて</button>
                        <button class="filter-btn px-4 py-2 text-sm rounded-full bg-gray-200 hover:bg-gray-300" data-filter="要約">要約</button>
                        <button class="filter-btn px-4 py-2 text-sm rounded-full bg-gray-200 hover:bg-gray-300" data-filter="作成">作成</button>
                        <button class="filter-btn px-4 py-2 text-sm rounded-full bg-gray-200 hover:bg-gray-300" data-filter="分析">分析</button>
                        <button class="filter-btn px-4 py-2 text-sm rounded-full bg-gray-200 hover:bg-gray-300" data-filter="整理">整理</button>
                        <button class="filter-btn px-4 py-2 text-sm rounded-full bg-gray-200 hover:bg-gray-300" data-filter="情報検索">情報検索</button>
                    </div>
                </div>
            </div>

            <div id="use-case-grid" class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
            </div>
        </section>

        <section id="best-practices" class="mb-16">
            <h3 class="text-2xl font-bold mb-6 text-center">ベストプラクティス：AIとの上手な対話法</h3>
            <p class="text-center text-gray-600 mb-8">プロンプト（指示）の質が、Copilotの回答の質を大きく左右します。このチャートでその関係性を確認してみましょう。</p>
            <div class="bg-white p-6 rounded-lg shadow-lg">
                <div class="chart-container">
                    <canvas id="promptQualityChart"></canvas>
                </div>
                
                <h4 class="text-xl font-bold mb-4 mt-8 text-center border-b pb-2">成功に導く「RAPフレームワーク」</h4>
                <div class="grid md:grid-cols-3 gap-4">
                    <div class="rap-item">
                        <div class="rap-icon">👤</div>
                        <div class="rap-text">
                            <h4>R: Role (役割)</h4>
                            <p>「あなたは〇〇の専門家です」「あなたは営業部長です」とAIに役割を与える。</p>
                        </div>
                    </div>
                    <div class="rap-item">
                        <div class="rap-icon">🎯</div>
                        <div class="rap-text">
                            <h4>A: Action (行動)</h4>
                            <p>「〇〇を作成してください」「〇〇を分析してください」と具体的なタスクを指示。</p>
                        </div>
                    </div>
                    <div class="rap-item">
                        <div class="rap-icon">💡</div>
                        <div class="rap-text">
                            <h4>P: Parameters (制約/形式)</h4>
                            <p>「箇条書きで」「ターゲットは経営層」「〇〇を含めて」と出力の制約を指定。</p>
                        </div>
                    </div>
                </div>

                 <div class="grid md:grid-cols-2 gap-8 mt-8">
                    <div class="bg-green-50 border-l-4 border-green-500 p-4 rounded">
                        <h4 class="font-bold text-lg mb-2">👍 DOs: 良いプロンプトのコツ</h4>
                        <ul class="list-disc list-inside text-gray-700 space-y-1">
                            <li><strong>具体的に：</strong> 目的、背景、文脈を詳しく伝える</li>
                            <li><strong>役割を与える：</strong> 「あなたは営業部長です」のように立場を指定</li>
                            <li><strong>形式を指定する：：</strong> 「箇条書きで」「表形式で」など出力形式を指示</li>
                            <li><strong>段階的に：</strong>複雑なタスクはステップに分けて依頼</li>
                            <li><strong>情報源を指定:</strong> 「このWord文書と添付のExcelファイルに基づいて」</li>
                        </ul>
                    </div>
                    <div class="bg-red-50 border-l-4 border-red-500 p-4 rounded">
                        <h4 class="font-bold text-lg mb-2">👎 DON'Ts: 避けるべきこと</h4>
                         <ul class="list-disc list-inside text-gray-700 space-y-1">
                            <li><strong>曖昧な言葉：：</strong> 「いい感じに」「よしなに」はNG</li>
                            <li><strong>情報不足：</strong> 前提となる情報やデータを与えない</li>
                            <li><strong>一度に多くを：：</strong> 複数の無関係な質問を一度にしない</li>
                            <li><strong>鵜呑みにする：</strong> 生成された内容は必ずファクトチェック</li>
                            <li><strong>機密情報の直接入力:</strong> センシティブな個人情報は極力避ける</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>
        
        <section id="faq">
            <h3 class="text-2xl font-bold mb-6 text-center">よくある質問 (FAQ)</h3>
            <div id="faq-container" class="space-y-4 max-w-3xl mx-auto">
                </div>
        </section>
    </main>
    
    <footer class="bg-white mt-16 py-6 border-t">
        <div class="content-container text-center text-gray-500">
            <p>&copy; 2025 SEIREN SHOJI Co., Ltd, All Rights Reserved.</p>
            <p class="text-sm mt-2">社内サポートデスク: 内線 1234 | <a href="#" class="text-[#5F9EA0] hover:underline">公式ドキュメントはこちら</a></p>
        </div>
    </footer>
    
    <div id="modal" class="modal fixed inset-0 flex items-center justify-center z-50 p-4">
        <div id="modal-content" class="modal-content bg-white rounded-lg shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto p-8">
            <div class="flex justify-between items-start mb-4">
                <div>
                    <span id="modal-app-icon" class="text-xl mr-1 align-middle"></span>
                    <span id="modal-app" class="inline-block bg-gray-200 text-gray-700 text-sm font-semibold mr-2 px-2.5 py-0.5 rounded-full align-middle"></span>
                    <span id="modal-task" class="inline-block bg-[#E0F2F1] text-[#00796B] text-sm font-semibold mr-2 px-2.5 py-0.5 rounded-full align-middle"></span>
                </div>
                <button id="modal-close" class="text-gray-500 hover:text-gray-800 text-3xl">&times;</button>
            </div>
            <h2 id="modal-title" class="text-2xl font-bold mb-4"></h2>
            
            <div class="space-y-6">
                <div>
                    <h3 class="font-bold text-lg mb-2 border-b-2 border-[#5F9EA0] pb-1">🎯 目的 (Goal)</h3>
                    <p id="modal-goal" class="text-gray-700"></p>
                </div>
                <div>
                    <h3 class="font-bold text-lg mb-2 border-b-2 border-[#5F9EA0] pb-1">🗣️ プロンプト例 (Prompt Example)</h3>
                    <div class="bg-gray-100 p-4 rounded-md relative">
                        <pre id="modal-prompt" class="whitespace-pre-wrap text-gray-800 text-sm leading-relaxed cursor-text"></pre>
                        <button class="copy-btn absolute top-2 right-2 bg-[#5F9EA0] text-white text-xs px-2 py-1 rounded hover:bg-[#4d8c8e] transition-colors">コピー</button>
                    </div>
                </div>
                <div>
                    <h3 class="font-bold text-lg mb-2 border-b-2 border-[#5F9EA0] pb-1">💡 期待される結果 (Expected Result)</h3>
                    <p id="modal-result" class="text-gray-700"></p>
                </div>
                <div>
                    <h3 class="font-bold text-lg mb-2 border-b-2 border-[#F08080] pb-1">🚀 上級者向けヒント (Pro Tip)</h3>
                    <p id="modal-tip" class="text-gray-700"></p>
                </div>
            </div>
        </div>
    </div>

<script>
document.addEventListener('DOMContentLoaded', () => {

    // === データ定義（アプリごとのアイコンを追加） ===
    const appIcons = {
        'Teams': '🔵',
        'Outlook': '📧',
        'PowerPoint': '🔴',
        'Word': '✍️',
        'Excel': '🟢',
        'Graph': '🌐' // 組織全体の情報検索用
    };
    
    // ユースケースを拡充 (8件から14件へ)
    const useCases = [
        { id: 1, app: 'Teams', task: '要約', title: '長引いた会議の要点を把握する', goal: '参加できなかった会議や、長くて追いきれなかった議論の要点と決定事項を短時間で理解する。', prompt: 'この会議の要約を作成してください。特に、[特定の議題]に関する決定事項と、各担当者へのアクションアイテムを明確にリストアップしてください。', result: '会議全体のサマリー、指定した議題に関する決定事項、個々のアクションアイテムが箇条書きで生成され、すぐに内容を把握できる。', tip: '「会議の雰囲気を教えて」「ポジティブな意見とネガティブな意見をまとめて」など、感情やニュアンスに関する要約も依頼できる。' },
        { id: 2, app: 'Outlook', task: '作成', title: '丁寧だが断りのメールを作成する', goal: '相手との関係を損なうことなく、依頼や招待を丁寧に断るためのメール文面を作成する。', prompt: 'あなたは[あなたの役職]です。[相手の名前]様からの[依頼内容]について、丁寧にお断りするメールを作成してください。理由は[断る理由]ですが、角が立たないように表現してください。代替案として[代替案]を提案し、今後の良好な関係を維持したい旨も伝えてください。', result: '件名、宛名から結びの言葉まで、ビジネスメールとして適切な構成で、丁寧かつ明確な断りの文面が生成される。', tip: '「よりフォーマルに」「もう少しカジュアルに」など、トーンの調整を指示することで、相手との関係性に合わせた文面を作成できる。' },
        { id: 3, app: 'PowerPoint', task: '作成', title: '既存のWord文書からプレゼンを生成する', goal: 'すでにある企画書やレポート（Word文書）をもとに、プレゼンテーションの骨子を自動で作成し、作業時間を大幅に短縮する。', prompt: '/Create presentation from file. 対象ファイル: [ファイル名.docx]', result: 'Word文書の見出し構造を解析し、タイトルスライド、目次、各章に対応するスライドが自動的に生成される。デザインや画像は最低限だが、構成のたたき台としては十分。', tip: '生成後、「このプレゼンのサマリースライドを追加して」「各スライドにスピーカーノートを生成して」といった追加指示で、内容をさらに充実させることができる。' },
        { id: 4, app: 'Excel', task: '分析', title: '売上データから傾向を分析する', goal: '複雑な数式やピボットテーブルを使わずに、売上データのシートから特定の傾向やインサイトを抽出する。', prompt: 'このテーブルの[列名]を分析し、月ごとの売上が最も高い製品トップ3を教えて。また、その結果をグラフで示して。', result: 'Copilotがデータを分析し、「〇月の売上トップ3は製品A, B, Cです」といったテキストでの回答と、その結果を視覚化した棒グラフなどを自動でシートに挿入する。', tip: '「売上が前月比で10%以上減少している製品をハイライトして」など、条件に基づいたデータの書式設定も指示できる。' },
        { id: 5, app: 'Word', task: '整理', title: '議事録のフォーマットを整える', goal: '箇条書きでメモしただけの議事録を、見出しや表を使って整形された、公式なフォーマットに整える。', prompt: 'このテキストを議事録として整形してください。会議名、日時、参加者を見出しとして立て、議題ごとにセクションを分けてください。決定事項とTODOは、それぞれ表形式でまとめてください。', result: 'テキスト全体が構造化され、見出しや太字、表などが適切に使用された、誰が見ても分かりやすい議事録に変換される。', tip: '「この文書のスタイルを、社内レポートの標準フォーマットに合わせて変更して」など、既存のスタイルテンプレートを適用させることも可能。' },
        { id: 6, app: 'Teams', task: '整理', title: 'チャットの会話からTODOを抽出する', goal: '活発なチャットのやり取りの中から、自分や他人に割り当てられたタスク（TODO）だけを抜き出してリスト化する。', prompt: '過去24時間のこのチャットから、私宛のタスクをすべてリストアップしてください。期限も併記してください。', result: '「（担当者名）-（タスク内容）-（期限）」の形式で、会話の中からタスクに関連する部分だけが抽出され、見やすいリストになる。', tip: '「このチャットでの主要な論点を3つにまとめて」など、タスク以外の情報整理にも応用できる。' },
        { id: 7, app: 'Outlook', task: '要約', title: '長いメールのスレッドを要約する', goal: '何往復も続いている長いメールのスレッドを読まずに、これまでの経緯と現在の状況を素早くキャッチアップする。', prompt: 'このメールのスレッドを要約して。', result: 'Copilotがスレッド全体を読み込み、各人の主張や決定事項、残課題などを時系列でまとめたサマリーを提示する。', tip: '要約が表示されている状態で、「〇〇さんの意見だけまとめて」「最終的な合意事項は何？」など、追加で深掘り質問ができる。' },
        { id: 8, app: 'PowerPoint', task: '整理', title: 'プレゼンテーション全体のデザインを統一する', goal: '各スライドでバラバラになっているデザインやフォントを、一貫性のあるテーマに沿って自動で修正する。', prompt: 'このプレゼンテーション全体を、青を基調としたミニマルなデザインに統一してください。', result: 'フォント、色、レイアウトが自動的に調整され、プロフェッショナルな印象の統一されたデザインに変換される。', tip: '「会社のロゴを全スライドの右下に追加して」など、ブランディングに関する指示も可能。' },
        
        // --- Geminiで追加したユースケース ---
        { id: 9, app: 'Graph', task: '情報検索', title: '全社の「〇〇に関する最新情報」を見つける', goal: 'どのフォルダやチームにあるか分からない、特定のプロジェクトや製品に関する最新の関連資料、メール、会議の記録を横断的に検索する。', prompt: '先月決定された「新プロジェクトX」に関するドキュメントと、その後の関連メールを要約して、アクションアイテムをリストアップしてください。', result: 'Outlook、Teams、SharePoint、OneDrive全体を検索し、関連性の高い情報だけを抽出して統合的なサマリーを生成する。', tip: '「私の直属の上司が共有したファイルのみ」のように、**共有者や日付の制約**を加えることで、検索精度が向上する。' },
        { id: 10, app: 'Word', task: '作成', title: '既存文書に基づいた競合分析レポートを作成する', goal: '特定の文書の内容をベースにしつつ、ウェブ検索機能も利用して、最新の競合情報を追加したレポートを作成する。', prompt: 'このWord文書（[ファイル名.docx]）を参考に、競合他社「Z社」の最新の市場シェアと新製品に関する情報をWebから検索し、新しいレポートを作成してください。レポートは箇条書きで、Z社との比較表を含めてください。', result: 'Word文書の内容とWebの最新情報を組み合わせたハイブリッドなレポートが生成される。', tip: 'Copilotのプロンプトで**外部の情報源**と**内部の情報源**を同時に指定することで、より包括的な結果が得られる。' },
        { id: 11, app: 'Excel', task: '整理', title: 'マクロコードを生成・修正する', goal: 'VBA（マクロ）の知識なしに、データ処理や書式設定の自動化コードを生成・修正してもらう。', prompt: 'このシートのA列のデータが重複していた場合、その行全体を削除するVBAコードを生成し、[マクロ名]として挿入してください。', result: 'ユーザーの要求に基づいたVBAコードが生成され、コードブロックとして提示される。Excel VBAエディタに直接挿入はできないが、提示されたコードを「開発」タブ →「Visual Basic」→「標準モジュール」に貼り付けて利用可能', tip: '生成されたコードは必ず**テスト環境**で動作確認すること。セキュリティ上のリスクを避けるため、意図しないコードが含まれていないかチェックする。' },
        { id: 12, app: 'Outlook', task: '整理', title: '受信トレイを瞬時に整理する', goal: '優先度の高いメールを見逃さず、過去のメールから必要な情報だけを抽出して対応を迅速化する。', prompt: '過去3日間のメールで、件名に「緊急」または「重要」が含まれるものをリストアップし、それぞれのメールから次のアクションを抽出してください。', result: '条件に合致するメールがリストアップされ、各メールの要約と、そこから読み取れる対応すべきタスクが明確に示される。', tip: 'メールを開かずにCopilotに指示し、**返信のドラフト作成**までを一括で行うことも可能。' },
        { id: 13, app: 'Teams', task: '作成', title: 'ブレインストーミング結果を構造化された提案に変換する', goal: 'チャネル内の自由なブレインストーミングのやり取りを、実行可能な提案書やアクションプランに整理する。', prompt: '過去1週間のチャネル内の議論を分析し、「新製品プロモーション」に関するアイデアを3つのカテゴリに分類してください。分類後、それぞれのアイデアを実行するための具体的なアクションプラン（担当者と期限を含む）を提案してください。', result: '雑然としたチャットデータが、整理されたカテゴリ、具体的な提案、実行可能なアクションプランの形式で出力される。', tip: '議論が長大な場合は、対象期間を限定することで、より早く、より関連性の高い結果が得られる。' },
        { id: 14, app: 'Word', task: '分析', title: '長文契約書の条項を分析し、リスクを抽出する', goal: '外部から受け取った長文の契約書や規約から、自社にとって特にリスクとなる条項や、不利な条件を短時間で特定する。', prompt: 'あなたは企業の法務担当者です。この契約書をレビューし、当社にとって最もリスクが高い、または交渉の余地がある条項を3つ抽出してください。また、それぞれの条項について、[特定の社内規約ファイル名]と照らし合わせ、コンプライアンス上の問題がないか検証してください。', result: '抽出された条項、それらが持つリスク、社内規約との比較結果が法務担当者の視点で記述される。', tip: 'プロンプトに**レビュー担当者の役割**（法務、財務など）を指定することで、その分野に特化した分析結果が得られる。' }

    ];

    const faqs = [
        { q: 'デスクトップ版のWordやExcelにCopilotが表示されません。', a: 'Microsoft 365 E1 ライセンスでは、Word、Excel、PowerPointのデスクトップアプリ（Office 2024など）へのCopilotの統合は提供されていません。Web版 Copilot (copilot.microsoft.com) または Teams/Outlook の Web版をご利用ください。' },
        { q: '期待した通りの回答が得られません。', a: '「ベストプラクティス」セクションを参考に、プロンプトをより具体的にしてみてください。目的、文脈、欲しい出力形式を明確に伝えることが重要です。**「RAPフレームワーク」**を意識してプロンプトを構成してみてください。' },
        { q: 'Copilotが生成した情報は正確ですか？', a: 'Copilotは強力ですが、誤った情報を生成することもあります（ハルシネーション）。特に、数値データや固有名詞を含む内容は、必ずご自身で**ファクトチェック**を行ってください。生成された内容をそのまま公式文書として利用するのは避けるべきです。' },
        { q: '社内情報を入力しても安全ですか？', a: 'Microsoft 365 Copilotは、組織内のセキュリティポリシーとコンプライアンスに基づいて動作します。入力したデータが外部に漏洩することはありません。Copilotはアクセス権限の範囲内でしか情報を参照しないため、通常の利用においては安全です。' },
        { q: '組織全体の検索（Graph）の精度を上げるには？', a: 'SharePointやOneDriveのファイルに<strong>適切なタグやメタデータ</strong>を付与し、整理することが最も重要です。また、自分が頻繁にアクセスするファイルや共同作業が多いユーザーとの連携が強化される傾向があります。' }
    ];

    // === DOM要素の取得 ===
    const grid = document.getElementById('use-case-grid');
    const appFilters = document.getElementById('app-filters');
    const taskFilters = document.getElementById('task-filters');
    const searchInput = document.getElementById('search-input'); // 検索バー
    const modal = document.getElementById('modal');
    const modalContent = document.getElementById('modal-content');
    const modalClose = document.getElementById('modal-close');
    const modalPrompt = document.getElementById('modal-prompt');
    const copyButton = document.querySelector('.copy-btn');

    // === カードの生成と表示ロジック ===
    const createCard = (item) => {
        const card = document.createElement('div');
        card.className = 'use-case-card bg-white p-6 rounded-lg shadow-md cursor-pointer';
        card.dataset.id = item.id;
        card.dataset.app = item.app;
        card.dataset.task = item.task;
        
        // 検索機能のためのデータ属性追加
        card.dataset.search = `${item.title} ${item.goal} ${item.prompt} ${item.app} ${item.task}`.toLowerCase();

        const icon = appIcons[item.app] || '✨'; // アイコン取得

        card.innerHTML = `
            <div class="flex items-center mb-3">
                <span class="text-xl mr-1">${icon}</span>
                <span class="inline-block bg-gray-200 text-gray-700 text-xs font-semibold mr-2 px-2.5 py-0.5 rounded-full">${item.app === 'Graph' ? '組織全体' : item.app}</span>
                <span class="inline-block bg-[#E0F2F1] text-[#00796B] text-xs font-semibold px-2.5 py-0.5 rounded-full">${item.task}</span>
            </div>
            <h4 class="text-lg font-bold">${item.title}</h4>
        `;
        card.addEventListener('click', () => openModal(item.id));
        return card;
    };

    const populateGrid = (items) => {
        grid.innerHTML = '';
        items.forEach(item => grid.appendChild(createCard(item)));
    };

    // === フィルター・検索ロジックの修正（マルチフィルターと検索に対応） ===
    const filterCards = () => {
        const activeAppFilters = Array.from(appFilters.querySelectorAll('.filter-btn.active:not([data-filter="all"])')).map(btn => btn.dataset.filter);
        const activeTaskFilters = Array.from(taskFilters.querySelectorAll('.filter-btn.active:not([data-filter="all"])')).map(btn => btn.dataset.filter);
        const searchTerm = searchInput.value.toLowerCase().trim();

        // 「すべて」が選択されているかどうか
        const isAppAllActive = appFilters.querySelector('[data-filter="all"]').classList.contains('active');
        const isTaskAllActive = taskFilters.querySelector('[data-filter="all"]').classList.contains('active');
        
        // 検索バーが空かどうか
        const isSearchEmpty = searchTerm.length === 0;

        useCases.forEach(item => {
            const cardElement = document.querySelector(`.use-case-card[data-id="${item.id}"]`);
            if (!cardElement) return;

            // アプリフィルターのマッチ判定
            let appMatch = isAppAllActive || activeAppFilters.includes(item.app);
            // タスクフィルターのマッチ判定
            let taskMatch = isTaskAllActive || activeTaskFilters.includes(item.task);
            
            // 検索ワードとのマッチ判定
            let searchMatch = isSearchEmpty || cardElement.dataset.search.includes(searchTerm);

            if (appMatch && taskMatch && searchMatch) {
                cardElement.classList.remove('hidden-card');
            } else {
                cardElement.classList.add('hidden-card');
            }
        });
    };
    
    // フィルターボタンのイベントリスナー（マルチ選択対応）
    const setupFilterListeners = (filterContainer) => {
        filterContainer.addEventListener('click', (e) => {
            const target = e.target.closest('button');
            if (!target) return;

            const filterValue = target.dataset.filter;
            const isAllButton = filterValue === 'all';
            
            if (isAllButton) {
                // 「すべて」が押された場合、他のボタンを解除し、「すべて」を有効化
                filterContainer.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
                target.classList.add('active');
            } else {
                // 他のボタンが押された場合
                const activeFilters = filterContainer.querySelectorAll('.filter-btn.active').length;
                const isTargetActive = target.classList.contains('active');

                if (isTargetActive && activeFilters === 1) {
                    // 最後の1つを解除しようとしたら「すべて」に切り替える
                    target.classList.remove('active');
                    filterContainer.querySelector('[data-filter="all"]').classList.add('active');
                } else if (isTargetActive) {
                    // 複数選択状態で解除
                    target.classList.remove('active');
                } else {
                    // 選択に追加
                    target.classList.add('active');
                    // 「すべて」ボタンが選択されていたら解除
                    filterContainer.querySelector('[data-filter="all"]').classList.remove('active');
                }
            }
            filterCards();
        });
    };

    setupFilterListeners(appFilters);
    setupFilterListeners(taskFilters);
    searchInput.addEventListener('input', filterCards);


    // === モーダル開閉ロジックの修正（トランジション対応） ===
    const openModal = (id) => {
        const item = useCases.find(uc => uc.id === id);
        if (!item) return;
        
        const icon = appIcons[item.app] || '✨';

        document.getElementById('modal-app-icon').textContent = icon; // アイコン
        document.getElementById('modal-app').textContent = item.app === 'Graph' ? '組織全体' : item.app; // 表示名も変更
        document.getElementById('modal-task').textContent = item.task;
        document.getElementById('modal-title').textContent = item.title;
        document.getElementById('modal-goal').textContent = item.goal;
        modalPrompt.textContent = item.prompt;
        document.getElementById('modal-result').textContent = item.result;
        document.getElementById('modal-tip').textContent = item.tip;
        
        // コピーボタンのテキストをリセット
        copyButton.textContent = 'コピー';

        // is-visible クラスを追加して表示
        modal.classList.add('is-visible');
    };

    const closeModal = () => {
        // is-visible クラスを削除して非表示
        modal.classList.remove('is-visible');
    };

    modalClose.addEventListener('click', closeModal);
    modal.addEventListener('click', (e) => {
        if (e.target === modal) {
            closeModal();
        }
    });
    
    // ESCキーでモーダルを閉じる
    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && modal.classList.contains('is-visible')) {
            closeModal();
        }
    });

    // プロンプトのコピー機能
    modalPrompt.addEventListener('click', () => {
        const range = document.createRange();
        range.selectNodeContents(modalPrompt);
        const selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);
    });

    copyButton.addEventListener('click', (e) => {
        const promptText = modalPrompt.textContent;
        // Clipboard APIを使用してコピー（モダンな方法）
        navigator.clipboard.writeText(promptText).then(() => {
            e.target.textContent = '✅ コピー完了！';
            setTimeout(() => { 
                e.target.textContent = 'コピー'; 
                // コピー後に選択状態を解除
                window.getSelection().removeAllRanges();
            }, 2000);
        }).catch(err => {
            // エラー時のフォールバック (document.execCommand('copy')を使用)
            const textArea = document.createElement("textarea");
            textArea.value = promptText;
            document.body.appendChild(textArea);
            textArea.select();
            document.execCommand('copy');
            document.body.removeChild(textArea);

            e.target.textContent = '✅ コピー完了！';
            setTimeout(() => { 
                e.target.textContent = 'コピー'; 
                window.getSelection().removeAllRanges();
            }, 2000);
        });
    });

    // === FAQ アコーディオン ===
    const populateFaqs = () => {
        const faqContainer = document.getElementById('faq-container');
        faqs.forEach(faq => {
            const div = document.createElement('div');
            div.className = 'bg-white rounded-lg shadow-md';
            div.innerHTML = `
                <button class="accordion-toggle w-full flex justify-between items-center text-left p-4 font-bold">
                    <span>${faq.q}</span>
                    <span class="transform transition-transform duration-300 text-[#5F9EA0] text-2xl font-light">+</span>
                </button>
                <div class="accordion-content px-4 pb-4">
                    <p class="text-gray-600">${faq.a}</p>
                </div>
            `;
            faqContainer.appendChild(div);
        });

        faqContainer.addEventListener('click', (e) => {
            const toggle = e.target.closest('.accordion-toggle');
            if (toggle) {
                const content = toggle.nextElementSibling;
                const icon = toggle.querySelector('span:last-child');
                
                if (content.style.maxHeight) {
                    content.style.maxHeight = null;
                    icon.classList.remove('rotate-45');
                    icon.textContent = '+';
                } else {
                    // 他の開いているアコーディオンを閉じる
                    document.querySelectorAll('.accordion-content').forEach(el => {
                        el.style.maxHeight = null;
                        const otherIcon = el.previousElementSibling.querySelector('span:last-child');
                        otherIcon.classList.remove('rotate-45');
                        otherIcon.textContent = '+';
                    });
                    // 自分自身を開く
                    content.style.maxHeight = content.scrollHeight + 'px';
                    icon.classList.add('rotate-45');
                    icon.textContent = '×';
                }
            }
        });
    };
    
    // === Chart.js ===
    const createChart = () => {
        const ctx = document.getElementById('promptQualityChart').getContext('2d');
        new Chart(ctx, {
            type: 'bar',
            data: {
                labels: ['曖昧な指示', '具体的な指示', '役割・制約を与えた指示 (RAP)'], // ラベルを修正
                datasets: [{
                    label: '得られる結果の質',
                    data: [3, 7, 9.8], // データを微修正
                    backgroundColor: [
                        'rgba(240, 128, 128, 0.6)',
                        'rgba(95, 158, 160, 0.6)',
                        'rgba(95, 158, 160, 0.9)'
                    ],
                    borderColor: [
                        'rgb(240, 128, 128)',
                        'rgb(95, 158, 160)',
                        'rgb(95, 158, 160)'
                    ],
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    y: {
                        beginAtZero: true,
                        max: 10,
                        title: {
                            display: true,
                            text: '結果の質 (10段階評価)'
                        }
                    }
                },
                plugins: {
                    legend: {
                        display: false
                    },
                    tooltip: {
                        callbacks: {
                            footer: (tooltipItems) => {
                                const tooltips = [
                                    '例: 「資料作って」→ 抽象的で良い結果は期待薄。',
                                    '例: 「新製品Aのプレゼンを10枚で作って」→ 具体的で一定の結果が得られる。',
                                    '例: 「あなたはマーケ部長として、経営層向けに新製品Aのプレゼンを10枚で作成。市場分析、競合、戦略を盛り込んで。」→ 最も質の高い結果が期待できる。'
                                ];
                                return tooltips[tooltipItems[0].dataIndex];
                            }
                        }
                    }
                }
            }
        });
    };

    // 初期処理の実行
    populateGrid(useCases);
    populateFaqs();
    // Chart.js の読み込み待ちが必要なため、DOMContentLoaded の後に実行
    if (typeof Chart !== 'undefined') {
        createChart();
    }
});
</script>
</body>
</html>


